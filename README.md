# Деплой приложения и инфры для laravel приложения

### Краткое описание всего процесса:
 - весь проект состоит из приложения и описания инфраструктуры
 - Предполагается что сначала поднимаем инфру и дальше в ней разворачиваем наше приложение
 - Отдельная репо для разворачивания инфраструктуры в облаке: https://github.com/IsieIam/infra - следовать её инструкциям.
 - Простое приложение laravel: https://github.com/IsieIam/laravel

### Структура репа:
- Local - ручной локальный стенд, основанный на docker-compose (см в каталоге подробное описание)
- Charts - helm чарт для приложения: состоит из чарта laravel-nginx - являющимся основным чартом приложения, laravel-nginx-exporter(метрики nginx) и двух зависимостей: mysql БД и memcached для кеша. Для ручного запуска достаточно создать в каталоге Charts/laravel файл values.yaml из одноименного файла example и запустить в этом каталоге команду:

```
helm install larka . -f values.yaml
# где larka - произвольное имя релиза
```

В результате поиска остался один вариант запуска laravel приложения - через совмещение в одном поде двух контейнеров: nginx + phpfpm, основной проблемой является необходимость передать nginx каталог public находящийся у php приложения.

### todo
- описать deployment/helm-чарт для adminer, хотя он не совсем относится к приложению, больше это как утилита в кластере
- реализовать деплой: программа min: через Jenkins по хуку от билд job-а, программа max: fluxcd
- рефакторинг кода